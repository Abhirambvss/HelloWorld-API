# Array to hold column data
$columnsData = @()

# Copy content from specific columns after applying AutoFilter
foreach ($columnName in $columnsByName) {
    $column = $usedRange.Rows.Item(1).EntireRow.Find($columnName)

    if ($column -ne $null) {
        $columnData = $column.EntireColumn.Value()
        $columnsData += ,$columnData  # Add column data to the array
    }
}

# Find the next empty column in the destination sheet
$destUsedRange = $destWorksheet.UsedRange
$destLastColumn = $destUsedRange.SpecialCells(11).Column + 1

# Define the range where you want to paste the columns in the destination file
$destRange = $destWorksheet.Cells.Item(1, $destLastColumn)
$destRange.Resize($columnsData[0].GetUpperBound(0), $columnsData.Count).Value() = $columnsData

# Save the destination workbook
$destWorkbook.Save()
