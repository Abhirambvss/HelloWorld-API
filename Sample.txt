# Path to your Excel file
$excelFilePath = "C:\path\to\your\excel_file.xlsx"

# Specify the sheet name and column name
$sheetName = "Sheet1$"  # Replace with your sheet name
$columnName = "Column1"  # Replace with your column name

# Array of values to search
$searchArray = @("Value1", "Value2", ... , "Value100")  # Replace with your search values

# Create a HashSet for faster lookup
$searchSet = [System.Collections.Generic.HashSet[string]]::new($searchArray)

# Connection string for Excel using OLEDB
$connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=$excelFilePath;Extended Properties='Excel 12.0 Xml;HDR=YES';"

# SQL query to retrieve data from the Excel file
$query = "SELECT * FROM [$sheetName]"

# Create a connection to Excel
$conn = New-Object System.Data.OleDb.OleDbConnection($connString)
$conn.Open()

# Create a command and execute the query
$cmd = New-Object System.Data.OleDb.OleDbCommand($query, $conn)
$reader = $cmd.ExecuteReader()

# Loop through the rows and search for values
while ($reader.Read()) {
    $cellValue = $reader[$columnName].ToString()
    if ($searchSet.Contains($cellValue)) {
        Write-Output "Value '$cellValue' found in column '$columnName' at row $($reader.GetOrdinal($columnName))."
        $searchSet.Remove($cellValue)  # Remove the found value from the set
        if ($searchSet.Count -eq 0) {
            break  # Exit the loop if all values are found
        }
    }
}

# Close the connection
$conn.Close()

# Display values not found
if ($searchSet.Count -gt 0) {
    foreach ($value in $searchSet) {
        Write-Output "Value '$value' not found in column '$columnName'."
    }
}
