# Path to your Excel file
$excelFilePath = "C:\Path\to\your\file.xlsx"

# Column name
$columnName = "YourColumnName"  # Replace with your column name

# Create a new Excel application object
$excel = New-Object -ComObject Excel.Application
$excel.Visible = $false

# Open the workbook
$workbook = $excel.Workbooks.Open($excelFilePath)
$worksheet = $workbook.Sheets.Item(1)

# Find the column by its name
$usedRange = $worksheet.UsedRange
$columnNumber = $usedRange.Rows.Item(1).Find($columnName).Column

# Get the used range of the column
$columnRange = $worksheet.Range($worksheet.Cells.Item(1, $columnNumber), $worksheet.Cells.Item($usedRange.Rows.Count, $columnNumber))
$valuesHashTable = @{}

# Get all values and their row numbers into a hashtable
foreach ($cell in $columnRange.Cells) {
    $valuesHashTable[$cell.Value2] = $cell.Row
}

# Display the hashtable
$valuesHashTable

# Close Excel without saving changes
$workbook.Close($false)
$excel.Quit()
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)
